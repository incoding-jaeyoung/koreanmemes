(()=>{var e={};e.id=615,e.ids=[615],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15609:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/damanegi/Desktop/dev/KoreanMemes/src/app/edit/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/damanegi/Desktop/dev/KoreanMemes/src/app/edit/[id]/page.tsx","default")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20224:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d});var a=t(65239),r=t(48088),l=t(88170),n=t.n(l),i=t(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let d={children:["",{children:["edit",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,15609)),"/Users/damanegi/Desktop/dev/KoreanMemes/src/app/edit/[id]/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/Users/damanegi/Desktop/dev/KoreanMemes/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}]}.children,c=["/Users/damanegi/Desktop/dev/KoreanMemes/src/app/edit/[id]/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/edit/[id]/page",pathname:"/edit/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39568:(e,s,t)=>{Promise.resolve().then(t.bind(t,15609))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74416:(e,s,t)=>{Promise.resolve().then(t.bind(t,83911))},79551:e=>{"use strict";e.exports=require("url")},83911:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var a=t(60687),r=t(43210),l=t(16189),n=t(41862),i=t(28559),o=t(13861),d=t(69282),c=t(11437),m=t(9005),x=t(8819),u=t(85814),p=t.n(u),h=t(8788),g=t(99765),b=t(39908);function f(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),[t,u]=(0,r.useState)(!0),[f,j]=(0,r.useState)(""),[y,v]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[C,K]=(0,r.useState)(""),[P,T]=(0,r.useState)("HUMOR"),[E,k]=(0,r.useState)(""),[S,A]=(0,r.useState)([]),[O,M]=(0,r.useState)(!1),[D,U]=(0,r.useState)(!1),[_,$]=(0,r.useState)(!1),[I,q]=(0,r.useState)(!1),[R,G]=(0,r.useState)(!1),[z,F]=(0,r.useState)([""]),[L,H]=(0,r.useState)([""]),[J,Y]=(0,r.useState)([]),B=e?.id,W=[{value:"HUMOR",label:"K-Humor \uD83D\uDE02",description:"Korean humor, memes, funny content"},{value:"CULTURE",label:"K-Culture \uD83C\uDFEE",description:"Korean culture, traditions, customs"},{value:"DRAMA",label:"K-Drama \uD83D\uDCFA",description:"K-Drama, entertainment, celebrities"},{value:"LIFESTYLE",label:"K-Lifestyle \uD83C\uDF38",description:"Korean daily life, lifestyle"},{value:"TECH",label:"K-Tech \uD83D\uDCBB",description:"Korean IT, startups, technology"},{value:"GENERAL",label:"General \uD83D\uDCAC",description:"Other Korean-related topics"}],Q=async(e,s)=>{if(!e.trim()){let e=[...L];e[s]="",H(e);return}if(!/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(e)||J[s])return;let t=[...J];t[s]=!0,Y(t);try{let t=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})}),a=await t.json();if(a.success&&a.translatedText){let e=[...L];e[s]=a.translatedText,H(e)}}catch(e){console.error("Comment translation error:",e)}finally{let e=[...J];e[s]=!1,Y(e)}},X=(e,s)=>{let t=[...z];t[e]=s,F(t),setTimeout(()=>{Q(s,e)},1e3)},V=()=>{F([...z,""]),H([...L,""])},Z=e=>{let s=z.filter((s,t)=>t!==e),t=L.filter((s,t)=>t!==e);F(0===s.length?[""]:s),H(0===t.length?[""]:t)},ee=async e=>{let s=ea(e);if(s.length>0){F(s),H(Array(s.length).fill(""));let e=s.map(async(e,s)=>{if(!e.trim()||!/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(e))return"";try{let s=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})}),t=await s.json();return t.success&&t.translatedText?t.translatedText:""}catch(e){return console.error(`Comment ${s+1} translation error:`,e),""}});H(await Promise.all(e))}},es=z.filter(e=>e.trim().length>0),et=L.filter((e,s)=>z[s]?.trim().length>0&&e.trim().length>0),ea=e=>{let s=e.split("\n").map(e=>e.trim()).filter(e=>e),t=[];console.log("=== 댓글 파싱 시작 ==="),console.log("총 라인 수:",s.length),console.log("처음 5줄:",s.slice(0,5));for(let e=0;e<s.length;e++){let a=s[e];if(console.log(`[${e}] 분석 중:`,a.substring(0,50)),a.includes("베스트")&&a.includes("	")){let r=a.split("	");if(r.length>1){let e=r[r.length-1].replace(/\[\d+\]/g,"").trim();if(e&&e.length>5&&!/^\d+\s*\d*$/.test(e)){console.log(`베스트 댓글 발견 (현재 줄):`,e),t.push(e);continue}}if(e+1<s.length){let a=s[e+1].replace(/\[\d+\]/g,"").trim();if(a&&a.length>5&&!a.includes("추천")&&!a.includes("반대")&&!/^\d+\s*\d*$/.test(a)){console.log(`베스트 댓글 발견 (다음 줄):`,a),t.push(a),e++;continue}}}if(a.includes("	")){let r=a.split("	");if(r.length>=2){let a=r[r.length-1].trim();if(a&&a.length>5&&!a.includes("추천")&&!a.includes("반대")&&!a.includes("이동")&&!a.includes("답글")&&!/^\d+\s*\d*$/.test(a)){console.log(`일반 댓글 발견 (현재 줄):`,a),t.push(a);continue}if(e+1<s.length){let a=s[e+1].trim();if(a&&a.length>5&&!a.includes("추천")&&!a.includes("반대")&&!a.includes("이동")&&!a.includes("답글")&&!/^\d+\s*\d*$/.test(a)){console.log(`일반 댓글 발견 (다음 줄):`,a),t.push(a),e++;continue}}}}/[ㄱ-ㅎㅏ-ㅣ가-힣]/.test(a)&&/[ㅋㅎㅠㅜㄷ;;!?]/.test(a)&&!a.includes("로그인")&&!a.includes("회원가입")&&!a.includes("메뉴")&&!a.includes("검색")&&!a.includes("추천")&&!a.includes("반대")&&a.length>=5&&a.length<=200&&(console.log(`직접 댓글 패턴 발견:`,a),t.push(a))}console.log("=== 파싱 결과 ==="),console.log("추출된 댓글 수:",t.length),console.log("댓글 목록:",t);let a=[...new Set(t)].slice(0,10);return console.log("최종 댓글 수:",a.length),a},er=(0,r.useCallback)(e=>{A(e)},[]),el=async e=>{e.preventDefault(),$(!0);try{let e=O?S.length>0?S[0]:"":E,t=O?S.slice(1):[],a=await fetch(`/api/posts/${B}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:f,koreanTitle:y,content:N,koreanContent:C,category:P,imageUrl:e,additionalImages:t,extractedComments:es.length>0?es:null,translatedComments:et.length>0?et:null})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to update post")}let r=await a.json();console.log("Post updated successfully:",r),s.push(`/post/${B}`)}catch(e){console.error("Post update error:",e),alert(`게시글 수정에 실패했습니다: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}finally{$(!1)}};return t?(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,a.jsx)(n.A,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading post..."})]})}):(0,a.jsx)(b.O,{children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(p(),{href:`/post/${B}`,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(i.A,{className:"h-5 w-5"}),"Back to Post"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Post"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Update your Korean culture content"})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("button",{type:"button",onClick:()=>U(!D),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),D?"Edit":"Preview"]})})]}),D?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("span",{className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium",children:W.find(e=>e.value===P)?.label})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:f||"Your English Title"}),y&&(0,a.jsxs)("p",{className:"text-gray-600 italic mb-6",children:["Original: ",y]}),E&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("img",{src:E,alt:"Featured",className:"w-full max-w-2xl mx-auto rounded-lg"})}),(0,a.jsxs)("div",{className:"prose max-w-none",children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap text-gray-800 leading-relaxed",children:N||"Your English content will appear here..."}),C&&(0,a.jsxs)("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Korean Original"}),(0,a.jsx)("div",{className:"whitespace-pre-wrap text-gray-700 leading-relaxed",children:C})]})]})]})}):(0,a.jsxs)("form",{onSubmit:el,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Category"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:W.map(e=>(0,a.jsxs)("label",{className:"relative",children:[(0,a.jsx)("input",{type:"radio",name:"category",value:e.value,checked:P===e.value,onChange:e=>T(e.target.value),className:"sr-only"}),(0,a.jsxs)("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${P===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.label}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]},e.value))})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"Korean Original Title"]}),(0,a.jsx)("input",{type:"text",value:y,onChange:e=>v(e.target.value),placeholder:"e.g., Korean Workplace Culture: The Mysterious World of 'Nunchi'",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"English Title",I&&(0,a.jsxs)("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[(0,a.jsx)(n.A,{className:"h-3 w-3 animate-spin"}),"Translating..."]})]}),(0,a.jsx)("input",{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"e.g., Korean Office Culture: The Mystery of 'Nunchi' Explained",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"English title will be automatically translated when you type Korean title"})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),"Featured Images (Optional)"]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Mode:"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"imageMode",checked:!O,onChange:()=>M(!1),className:"text-blue-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Single"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"imageMode",checked:O,onChange:()=>M(!0),className:"text-blue-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Multiple"})]})]})]}),O?(0,a.jsx)(g.l,{onImagesChange:er,currentImages:S,maxImages:5}):(0,a.jsx)(h.B,{onImageUploaded:e=>{k(e)},currentImage:E,onRemoveImage:()=>{k("")}})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"Korean Original Content (Optional)"]}),(0,a.jsx)("textarea",{value:C,onChange:e=>K(e.target.value),placeholder:"Enter original content about Korean culture or humor...",rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-vertical"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"English Translation Content (Optional)",R&&(0,a.jsxs)("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[(0,a.jsx)(n.A,{className:"h-3 w-3 animate-spin"}),"Translating..."]})]}),(0,a.jsx)("textarea",{value:N,onChange:e=>w(e.target.value),placeholder:"Translate and explain Korean culture or humor in English...",rows:10,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-vertical"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"English content will be automatically translated when you type Korean content"})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Korean Community Comments (Optional)"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Add best comments from Korean community sites manually"}),(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCA1 Quick Input: Paste copied comment text"}),(0,a.jsx)("textarea",{placeholder:"Paste comment text copied from Korean community sites here...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-sm",onPaste:e=>{e.preventDefault(),ee(e.clipboardData.getData("text"))}}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Only comment content will be automatically extracted when pasted"})]})]}),z.map((e,s)=>(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-xs text-gray-600 mb-1 block",children:["Korean Original",J[s]&&(0,a.jsxs)("span",{className:"ml-2 text-blue-600 flex items-center gap-1 inline-flex",children:[(0,a.jsx)(n.A,{className:"h-3 w-3 animate-spin"}),"Translating..."]})]}),(0,a.jsx)("textarea",{value:e,onChange:e=>X(s,e.target.value),placeholder:`Enter comment ${s+1}...`,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),L[s]&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 mb-1 block",children:"English Translation"}),(0,a.jsx)("div",{className:"w-full px-3 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm text-gray-700",children:L[s]})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[s===z.length-1&&(0,a.jsx)("button",{type:"button",onClick:V,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"+"}),z.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>Z(s),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"\xd7"})]})]})},s)),es.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["Preview (",es.length," comments)"]}),(0,a.jsx)("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:es.map((e,s)=>(0,a.jsx)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-blue-600 font-medium",children:"Korean:"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e})]}),et[s]&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"English:"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:et[s]})]})]})},s))}),(0,a.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"✓ These comments will be displayed at the bottom of your post in both languages"})]})]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)(p(),{href:`/post/${B}`,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:_||!f.trim()||!y.trim(),className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.A,{className:"h-4 w-4 animate-spin"}),"Updating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),"Update Post"]})})]})]})]})})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[447,625,278,236,411],()=>t(20224));module.exports=a})();