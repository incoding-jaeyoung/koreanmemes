"use strict";(()=>{var e={};e.id=619,e.ids=[619],e.modules={1708:e=>{e.exports=require("node:process")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7066:e=>{e.exports=require("node:tty")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16698:e=>{e.exports=require("node:async_hooks")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30003:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>m,serverHooks:()=>g,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{DELETE:()=>c,GET:()=>p,PUT:()=>l});var o=r(96559),n=r(48088),a=r(37719),i=r(32190),d=r(38824),u=r(31183);async function p(e,{params:t}){try{let{id:e}=await t,r=await u.z.post.findUnique({where:{id:e},select:{id:!0,title:!0,koreanTitle:!0,content:!0,koreanContent:!0,extractedComments:!0,translatedComments:!0,category:!0,imageUrl:!0,additionalImages:!0,likes:!0,views:!0,createdAt:!0,updatedAt:!0,_count:{select:{comments:{where:{isBlocked:!1}}}}}});if(!r)return i.NextResponse.json({error:"Post not found"},{status:404});let s={...r,commentCount:r._count.comments,additionalImages:Array.isArray(r.additionalImages)?r.additionalImages:[],extractedComments:Array.isArray(r.extractedComments)?r.extractedComments:[],translatedComments:Array.isArray(r.translatedComments)?r.translatedComments:[],_count:void 0};return i.NextResponse.json({post:s})}catch(e){return console.error("Post fetch error:",e),i.NextResponse.json({error:"Failed to fetch post"},{status:500})}}async function l(e,{params:t}){try{let{id:r}=await t,{title:s,koreanTitle:o,content:n,koreanContent:a,category:p,imageUrl:l,additionalImages:c,extractedComments:m,translatedComments:x}=await e.json();if(!s||!p)return i.NextResponse.json({error:"Title and category are required"},{status:400});if(!Object.values(d.Category).includes(p))return i.NextResponse.json({error:"Invalid category"},{status:400});if(!await u.z.post.findUnique({where:{id:r}}))return i.NextResponse.json({error:"Post not found"},{status:404});let y=await u.z.post.update({where:{id:r},data:{title:s,koreanTitle:o||null,content:n||"",koreanContent:a||null,extractedComments:m&&Array.isArray(m)&&m.length>0?JSON.parse(JSON.stringify(m)):void 0,translatedComments:x&&Array.isArray(x)&&x.length>0?JSON.parse(JSON.stringify(x)):void 0,category:p,imageUrl:l||null,additionalImages:c&&Array.isArray(c)&&c.length>0?JSON.parse(JSON.stringify(c)):void 0}});return console.log("Post updated:",y.id),i.NextResponse.json({success:!0,post:{id:y.id,title:y.title,category:y.category},message:"Post updated successfully"})}catch(e){return console.error("Post update error:",e),i.NextResponse.json({error:"Failed to update post",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function c(e,{params:t}){try{let{id:e}=await t;if(!await u.z.post.findUnique({where:{id:e}}))return i.NextResponse.json({error:"Post not found"},{status:404});return await u.z.post.delete({where:{id:e}}),console.log("Post deleted:",e),i.NextResponse.json({success:!0,message:"Post deleted successfully"})}catch(e){return console.error("Post delete error:",e),i.NextResponse.json({error:"Failed to delete post",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/posts/[id]/route",pathname:"/api/posts/[id]",filename:"route",bundlePath:"app/api/posts/[id]/route"},resolvedPagePath:"/Users/damanegi/Desktop/dev/KoreanMemes/src/app/api/posts/[id]/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:y,serverHooks:g}=m;function f(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:y})}},31421:e=>{e.exports=require("node:child_process")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48161:e=>{e.exports=require("node:os")},51455:e=>{e.exports=require("node:fs/promises")},57975:e=>{e.exports=require("node:util")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{e.exports=require("node:fs")},76760:e=>{e.exports=require("node:path")},77598:e=>{e.exports=require("node:crypto")},78474:e=>{e.exports=require("node:events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580,275],()=>r(30003));module.exports=s})();