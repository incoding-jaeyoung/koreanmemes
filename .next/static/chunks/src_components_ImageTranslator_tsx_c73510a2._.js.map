{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/damanegi/Desktop/dev/KoreanMemes/src/components/ImageTranslator.tsx"],"sourcesContent":["'use client'\n\nimport React, { useRef, useEffect, useState, useCallback } from 'react'\n\ninterface SelectionBox {\n  startX: number\n  startY: number\n  width: number\n  height: number\n  id: string\n  translatedText?: string\n  isTranslating?: boolean\n}\n\ninterface ImageTranslatorProps {\n  imageFile: File\n  onTranslationComplete: (translatedImageUrl: string) => void\n  onCancel: () => void\n}\n\nexport default function ImageTranslator({ imageFile, onTranslationComplete, onCancel }: ImageTranslatorProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null)\n  const [image, setImage] = useState<HTMLImageElement | null>(null)\n  const [isDrawing, setIsDrawing] = useState(false)\n  const [currentSelection, setCurrentSelection] = useState<SelectionBox | null>(null)\n  const [selections, setSelections] = useState<SelectionBox[]>([])\n  const [isTranslating, setIsTranslating] = useState(false)\n  const [scale, setScale] = useState({ x: 1, y: 1 })\n  const [startPoint, setStartPoint] = useState<{ x: number; y: number } | null>(null)\n  const [hoveredSelection, setHoveredSelection] = useState<string | null>(null)\n\n  // Ïù¥ÎØ∏ÏßÄ Î°úÎìú\n  useEffect(() => {\n    if (!imageFile) return\n    \n    const img = new Image()\n    img.onload = () => {\n      setImage(img)\n      const canvas = canvasRef.current\n      if (canvas) {\n        // Ïª®ÌÖåÏù¥ÎÑà ÎÑàÎπÑÏóê ÎßûÍ≤å Ï∫îÎ≤ÑÏä§ ÌÅ¨Í∏∞ ÏÑ§Ï†ï\n        const container = canvas.parentElement\n        if (container) {\n          const containerWidth = container.clientWidth\n          const imgRatio = img.width / img.height\n          \n          // Í∞ÄÎ°úÎ•º Ïª®ÌÖåÏù¥ÎÑà ÎÑàÎπÑÏóê ÎßûÏ∂îÍ≥† ÎπÑÏú®Ïóê Îî∞Îùº ÏÑ∏Î°ú Í≥ÑÏÇ∞\n          const displayWidth = containerWidth\n          const displayHeight = containerWidth / imgRatio\n          \n          // Ï∫îÎ≤ÑÏä§ ÌÅ¨Í∏∞Î•º ÌôîÎ©¥ ÌëúÏãú ÌÅ¨Í∏∞Î°ú ÏÑ§Ï†ï (Ï¢åÌëú ÏùºÏπòÎ•º ÏúÑÌï¥)\n          canvas.width = displayWidth\n          canvas.height = displayHeight\n          canvas.style.width = `${displayWidth}px`\n          canvas.style.height = `${displayHeight}px`\n          \n          // Ïä§ÏºÄÏùº ÎπÑÏú® Í≥ÑÏÇ∞: ÌôîÎ©¥ ÌÅ¨Í∏∞ ‚Üí ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞\n          setScale({\n            x: img.width / displayWidth,   // ÌôîÎ©¥ Ï¢åÌëúÎ•º ÏõêÎ≥∏ Ï¢åÌëúÎ°ú Î≥ÄÌôòÌïòÎäî ÎπÑÏú®\n            y: img.height / displayHeight\n          })\n          \n          // Ï∫îÎ≤ÑÏä§Ïóê Ïù¥ÎØ∏ÏßÄ Í∑∏Î¶¨Í∏∞ (ÌëúÏãú ÌÅ¨Í∏∞Ïóê ÎßûÏ∂§)\n          const ctx = canvas.getContext('2d')\n          if (ctx) {\n            ctx.drawImage(img, 0, 0, displayWidth, displayHeight)\n          }\n        }\n      }\n    }\n    \n    const url = URL.createObjectURL(imageFile)\n    img.src = url\n    \n    return () => URL.revokeObjectURL(url)\n  }, [imageFile])\n\n  // Ï∫îÎ≤ÑÏä§ Í∑∏Î¶¨Í∏∞\n  const drawCanvas = useCallback(() => {\n    const canvas = canvasRef.current\n    const ctx = canvas?.getContext('2d')\n    if (!canvas || !ctx || !image) return\n\n    // Î∞∞Í≤Ω ÌÅ¥Î¶¨Ïñ¥\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    \n    // Ïù¥ÎØ∏ÏßÄ Í∑∏Î¶¨Í∏∞ (ÌôîÎ©¥ ÌÅ¨Í∏∞Ïóê ÎßûÏ∂§)\n    ctx.drawImage(image, 0, 0, canvas.width, canvas.height)\n    \n    // Í∏∞Ï°¥ Î≤àÏó≠Îêú ÏòÅÏó≠Îì§ Í∑∏Î¶¨Í∏∞ (ÌôîÎ©¥ Ï¢åÌëúÍ≥ÑÏóêÏÑú ÏßÅÏ†ë Í∑∏Î¶¨Í∏∞)\n    selections.forEach(selection => {\n      if (selection.translatedText) {\n        // ÏÑ†ÌÉù ÏòÅÏó≠ÏùÄ ÌôîÎ©¥ Ï¢åÌëúÍ≥Ñ Í∏∞Ï§ÄÏù¥ÎØÄÎ°ú ÏßÅÏ†ë ÏÇ¨Ïö©\n        const boxX = selection.startX\n        const boxY = selection.startY\n        const boxWidth = selection.width\n        const boxHeight = selection.height\n        \n        // Î∞òÌà¨Î™Ö Í≤ÄÏùÄÏÉâ Î∞∞Í≤Ω (85% Ìà¨Î™ÖÎèÑ)\n        ctx.fillStyle = 'rgba(0, 0, 0, 0.85)'\n        ctx.fillRect(boxX, boxY, boxWidth, boxHeight)\n        \n        // Í≤ΩÍ≥ÑÏÑ† (Ìò∏Î≤ÑÎêú ÏòÅÏó≠ÏùÄ Îπ®Í∞ÑÏÉâÏúºÎ°ú ÌëúÏãú)\n        if (hoveredSelection === selection.id) {\n          ctx.strokeStyle = '#ff0000'\n        } else {\n          ctx.strokeStyle = '#333333'\n        }\n        ctx.lineWidth = 1\n        ctx.strokeRect(boxX, boxY, boxWidth, boxHeight)\n        \n        // X Î™®Ïñë ÏÇ≠Ï†ú ÌëúÏãú (Ìò∏Î≤ÑÎêú ÏòÅÏó≠ÏóêÎßå)\n        if (hoveredSelection === selection.id) {\n          ctx.strokeStyle = '#ff6666'\n          ctx.lineWidth = 2\n          const margin = Math.min(boxWidth, boxHeight) * 0.1\n          \n          // X Í∑∏Î¶¨Í∏∞\n          ctx.beginPath()\n          ctx.moveTo(boxX + margin, boxY + margin)\n          ctx.lineTo(boxX + boxWidth - margin, boxY + boxHeight - margin)\n          ctx.stroke()\n          \n          ctx.beginPath()\n          ctx.moveTo(boxX + boxWidth - margin, boxY + margin)\n          ctx.lineTo(boxX + margin, boxY + boxHeight - margin)\n          ctx.stroke()\n        }\n        \n        // Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶àÎ•º ÏòÅÏó≠Ïóê ÎßûÍ≤å ÎèôÏ†Å Í≥ÑÏÇ∞\n        const maxTextWidth = boxWidth * 0.9\n        const maxTextHeight = boxHeight * 0.9\n        \n        // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà Ï≤òÎ¶¨\n        const words = selection.translatedText.split(' ')\n        \n        // Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶àÎ•º Ï∞æÍ∏∞ ÏúÑÌïú Ïù¥ÏßÑ ÌÉêÏÉâ\n        let fontSize = Math.min(boxHeight * 0.3, 40) // ÏãúÏûë Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶à\n        const minFontSize = 8\n        const maxFontSize = Math.min(boxHeight * 0.5, 60)\n        let bestFontSize = minFontSize\n        \n        // ÏµúÏ†Å Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶à Ï∞æÍ∏∞\n        for (let testSize = minFontSize; testSize <= maxFontSize; testSize += 2) {\n          ctx.font = `bold ${testSize}px Arial, sans-serif`\n          \n          // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà ÌÖåÏä§Ìä∏\n          const lines: string[] = []\n          let currentLine = ''\n          \n          for (const word of words) {\n            const testLine = currentLine ? `${currentLine} ${word}` : word\n            const testWidth = ctx.measureText(testLine).width\n            \n            if (testWidth <= maxTextWidth) {\n              currentLine = testLine\n            } else {\n              if (currentLine) {\n                lines.push(currentLine)\n                currentLine = word\n              } else {\n                lines.push(word)\n              }\n            }\n          }\n          if (currentLine) lines.push(currentLine)\n          \n          // Ï¥ù ÎÜíÏù¥ Í≥ÑÏÇ∞\n          const lineHeight = testSize * 1.3\n          const totalHeight = lines.length * lineHeight\n          \n          // ÌÖçÏä§Ìä∏Í∞Ä ÏòÅÏó≠Ïóê Îì§Ïñ¥Í∞ÄÎäîÏßÄ ÌôïÏù∏\n          if (totalHeight <= maxTextHeight) {\n            bestFontSize = testSize\n          } else {\n            break\n          }\n        }\n        \n        // ÏµúÏ¢Ö Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶à Ï†ÅÏö©\n        fontSize = Math.max(bestFontSize, minFontSize)\n        ctx.font = `bold ${fontSize}px Arial, sans-serif`\n        ctx.fillStyle = 'white'  // ÌÖçÏä§Ìä∏ ÏÉâÏÉÅÏùÑ Ìù∞ÏÉâÏúºÎ°ú Î≥ÄÍ≤Ω\n        ctx.textAlign = 'center'\n        ctx.textBaseline = 'top'\n        \n        // ÏµúÏ¢Ö ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà\n        const lines: string[] = []\n        let currentLine = ''\n        \n        for (const word of words) {\n          const testLine = currentLine ? `${currentLine} ${word}` : word\n          const testWidth = ctx.measureText(testLine).width\n          \n          if (testWidth <= maxTextWidth) {\n            currentLine = testLine\n          } else {\n            if (currentLine) {\n              lines.push(currentLine)\n              currentLine = word\n            } else {\n              lines.push(word)\n            }\n          }\n        }\n        if (currentLine) lines.push(currentLine)\n        \n        // Îã§Ï§ë ÎùºÏù∏ ÌÖçÏä§Ìä∏ Í∑∏Î¶¨Í∏∞\n        const lineHeight = fontSize * 1.3\n        const totalTextHeight = lines.length * lineHeight\n        const startY = boxY + (boxHeight - totalTextHeight) / 2\n        \n        lines.forEach((line, index) => {\n          const lineY = startY + index * lineHeight\n          const lineX = boxX + boxWidth / 2\n          ctx.fillText(line, lineX, lineY)\n        })\n      } else if (selection.isTranslating) {\n        // Î≤àÏó≠ Ï§ë ÌëúÏãú (ÌôîÎ©¥ Ï¢åÌëúÍ≥ÑÏóêÏÑú ÏßÅÏ†ë Í∑∏Î¶¨Í∏∞)\n        ctx.fillStyle = 'rgba(255, 255, 0, 0.3)'\n        ctx.fillRect(selection.startX, selection.startY, selection.width, selection.height)\n        \n        ctx.strokeStyle = '#ffd700'\n        ctx.lineWidth = 2\n        ctx.strokeRect(selection.startX, selection.startY, selection.width, selection.height)\n        \n        ctx.fillStyle = 'white'  // Î≤àÏó≠ Ï§ë ÌÖçÏä§Ìä∏ÎèÑ Ìù∞ÏÉâÏúºÎ°ú Î≥ÄÍ≤Ω\n        ctx.font = 'bold 16px Arial'\n        ctx.textAlign = 'center'\n        ctx.textBaseline = 'middle'\n        ctx.fillText('Î≤àÏó≠ Ï§ë...', selection.startX + selection.width / 2, selection.startY + selection.height / 2)\n      }\n    })\n    \n    // ÌòÑÏû¨ ÏÑ†ÌÉù Ï§ëÏù∏ ÏòÅÏó≠ Í∑∏Î¶¨Í∏∞ (ÌôîÎ©¥ Ï¢åÌëúÍ≥ÑÏóêÏÑú ÏßÅÏ†ë Í∑∏Î¶¨Í∏∞)\n    if (currentSelection) {\n      ctx.strokeStyle = '#ff0000'\n      ctx.lineWidth = 2\n      ctx.setLineDash([5, 5])\n      ctx.strokeRect(currentSelection.startX, currentSelection.startY, currentSelection.width, currentSelection.height)\n      ctx.setLineDash([])\n    }\n  }, [image, selections, currentSelection, scale, hoveredSelection])\n\n  // selectionsÍ∞Ä Î≥ÄÍ≤ΩÎê† Îïå Ï∫îÎ≤ÑÏä§ Îã§Ïãú Í∑∏Î¶¨Í∏∞\n  useEffect(() => {\n    drawCanvas()\n  }, [selections, hoveredSelection, drawCanvas])\n\n  // ÎßàÏö∞Ïä§ Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨Îì§\n  const handleMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!image) return\n    \n    const canvas = canvasRef.current\n    if (!canvas) return\n    \n    const rect = canvas.getBoundingClientRect()\n    // ÌôîÎ©¥ Ï¢åÌëúÎ•º Ï∫îÎ≤ÑÏä§ Ï¢åÌëúÎ°ú Î≥ÄÌôò (Ï∫îÎ≤ÑÏä§ÏôÄ ÌôîÎ©¥Ïù¥ ÎèôÏùºÌïú ÌÅ¨Í∏∞Ïù¥ÎØÄÎ°ú ÏßÅÏ†ë ÏÇ¨Ïö©)\n    const x = e.clientX - rect.left\n    const y = e.clientY - rect.top\n    \n    // Í∏∞Ï°¥ ÏÑ†ÌÉù ÏòÅÏó≠ ÌÅ¥Î¶≠ ÌôïÏù∏ (Ïó≠ÏàúÏúºÎ°ú Ï≤¥ÌÅ¨ÌïòÏó¨ ÏµúÏã† ÏòÅÏó≠ Ïö∞ÏÑ†)\n    for (let i = selections.length - 1; i >= 0; i--) {\n      const selection = selections[i]\n      if (x >= selection.startX && x <= selection.startX + selection.width &&\n          y >= selection.startY && y <= selection.startY + selection.height) {\n        // Í∏∞Ï°¥ ÏòÅÏó≠ ÌÅ¥Î¶≠ Ïãú ÏÇ≠Ï†ú\n        setSelections(prev => prev.filter(sel => sel.id !== selection.id))\n        return\n      }\n    }\n    \n    // ÏÉàÎ°úÏö¥ ÏòÅÏó≠ ÏÑ†ÌÉù ÏãúÏûë\n    setIsDrawing(true)\n    setStartPoint({ x, y })\n    setCurrentSelection({\n      id: `selection-${Date.now()}`,\n      startX: x,\n      startY: y,\n      width: 0,\n      height: 0,\n      isTranslating: false,\n      translatedText: ''\n    })\n  }\n\n  const handleMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const canvas = canvasRef.current\n    if (!canvas) return\n    \n    const rect = canvas.getBoundingClientRect()\n    // ÌôîÎ©¥ Ï¢åÌëúÎ•º Ï∫îÎ≤ÑÏä§ Ï¢åÌëúÎ°ú Î≥ÄÌôò (Ï∫îÎ≤ÑÏä§ÏôÄ ÌôîÎ©¥Ïù¥ ÎèôÏùºÌïú ÌÅ¨Í∏∞Ïù¥ÎØÄÎ°ú ÏßÅÏ†ë ÏÇ¨Ïö©)\n    const x = e.clientX - rect.left\n    const y = e.clientY - rect.top\n    \n    // Ìò∏Î≤ÑÎêú ÏÑ†ÌÉù ÏòÅÏó≠ Ï∞æÍ∏∞\n    let hoveredId: string | null = null\n    for (let i = selections.length - 1; i >= 0; i--) {\n      const selection = selections[i]\n      if (x >= selection.startX && x <= selection.startX + selection.width &&\n          y >= selection.startY && y <= selection.startY + selection.height) {\n        hoveredId = selection.id\n        break\n      }\n    }\n    setHoveredSelection(hoveredId)\n    \n    // ÎìúÎûòÍ∑∏ Ï§ëÏù∏ Í≤ΩÏö∞\n    if (isDrawing && startPoint && image) {\n      const currentX = x\n      const currentY = y\n      \n      const width = currentX - startPoint.x\n      const height = currentY - startPoint.y\n      \n      setCurrentSelection(prev => prev ? {\n        ...prev,\n        width: Math.abs(width),\n        height: Math.abs(height),\n        startX: width < 0 ? currentX : startPoint.x,\n        startY: height < 0 ? currentY : startPoint.y\n      } : null)\n      \n      // Ï∫îÎ≤ÑÏä§ Îã§Ïãú Í∑∏Î¶¨Í∏∞\n      drawCanvas()\n    }\n  }\n\n  // Ïö∞ÌÅ¥Î¶≠ Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥\n  const handleContextMenu = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    e.preventDefault()\n    \n    if (!image) return\n    \n    const canvas = canvasRef.current\n    if (!canvas) return\n    \n    const rect = canvas.getBoundingClientRect()\n    // ÌôîÎ©¥ Ï¢åÌëúÎ•º Ï∫îÎ≤ÑÏä§ Ï¢åÌëúÎ°ú Î≥ÄÌôò (Ï∫îÎ≤ÑÏä§ÏôÄ ÌôîÎ©¥Ïù¥ ÎèôÏùºÌïú ÌÅ¨Í∏∞Ïù¥ÎØÄÎ°ú ÏßÅÏ†ë ÏÇ¨Ïö©)\n    const x = e.clientX - rect.left\n    const y = e.clientY - rect.top\n    \n    // Ïö∞ÌÅ¥Î¶≠Ìïú ÏúÑÏπòÏùò ÏÑ†ÌÉù ÏòÅÏó≠ Ï∞æÍ∏∞\n    for (let i = selections.length - 1; i >= 0; i--) {\n      const selection = selections[i]\n      if (x >= selection.startX && x <= selection.startX + selection.width &&\n          y >= selection.startY && y <= selection.startY + selection.height) {\n        // Ìï¥Îãπ ÏòÅÏó≠ ÏÇ≠Ï†ú\n        setSelections(prev => prev.filter(sel => sel.id !== selection.id))\n        return\n      }\n    }\n  }\n\n  const handleMouseUp = async () => {\n    if (!isDrawing || !currentSelection) return\n\n    setIsDrawing(false)\n\n    // ÎÑàÎ¨¥ ÏûëÏùÄ ÏÑ†ÌÉù ÏòÅÏó≠ÏùÄ Î¨¥Ïãú\n    if (Math.abs(currentSelection.width) < 20 || Math.abs(currentSelection.height) < 20) {\n      setCurrentSelection(null)\n      return\n    }\n\n    // ÏùåÏàò ÌÅ¨Í∏∞ Ï†ïÍ∑úÌôî\n    const normalizedSelection = {\n      ...currentSelection,\n      startX: currentSelection.width < 0 ? currentSelection.startX + currentSelection.width : currentSelection.startX,\n      startY: currentSelection.height < 0 ? currentSelection.startY + currentSelection.height : currentSelection.startY,\n      width: Math.abs(currentSelection.width),\n      height: Math.abs(currentSelection.height),\n      isTranslating: true\n    }\n\n    // ÏÑ†ÌÉù ÏòÅÏó≠ÏùÑ Î™©Î°ùÏóê Ï∂îÍ∞Ä\n    setSelections(prev => [...prev, normalizedSelection])\n    setCurrentSelection(null)\n\n    // OCR Î∞è Î≤àÏó≠ ÏàòÌñâ\n    await translateSelectedArea(normalizedSelection)\n  }\n\n  // ÏÑ†ÌÉùÎêú ÏòÅÏó≠ Î≤àÏó≠\n  const translateSelectedArea = async (selection: SelectionBox) => {\n    try {\n      // ÏÑ†ÌÉùÎêú ÏòÅÏó≠Ïùò Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú\n      const canvas = document.createElement('canvas')\n      const ctx = canvas.getContext('2d')\n      if (!ctx || !image) return\n\n      // ÌôîÎ©¥ Ï¢åÌëúÎ•º ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄ Ï¢åÌëúÎ°ú Î≥ÄÌôò\n      const originalX = selection.startX * scale.x\n      const originalY = selection.startY * scale.y\n      const originalWidth = selection.width * scale.x\n      const originalHeight = selection.height * scale.y\n\n      canvas.width = originalWidth\n      canvas.height = originalHeight\n\n      // ÏÑ†ÌÉùÎêú ÏòÅÏó≠Îßå Ï∫îÎ≤ÑÏä§Ïóê Í∑∏Î¶¨Í∏∞ (ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄÏóêÏÑú Ìï¥Îãπ ÏòÅÏó≠ Ï∂îÏ∂ú)\n      ctx.drawImage(\n        image,\n        originalX, originalY, originalWidth, originalHeight,\n        0, 0, originalWidth, originalHeight\n      )\n\n      // Ï∫îÎ≤ÑÏä§Î•º BlobÏúºÎ°ú Î≥ÄÌôò\n      const blob = await new Promise<Blob>((resolve) => {\n        canvas.toBlob((blob) => resolve(blob!), 'image/png')\n      })\n\n      // FormDataÎ°ú API Ìò∏Ï∂ú\n      const formData = new FormData()\n      formData.append('image', blob, 'selection.png')\n      formData.append('ocrOnly', 'true')\n\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        body: formData\n      })\n\n      const result = await response.json()\n      \n      if (result.success && result.translatedText) {\n        // Î≤àÏó≠ ÏôÑÎ£å - ÏÑ†ÌÉù ÏòÅÏó≠ ÏóÖÎç∞Ïù¥Ìä∏\n        console.log('üìù Î≤àÏó≠ ÏôÑÎ£å:', result.translatedText)\n        setSelections(prev => prev.map(sel => \n          sel.id === selection.id \n            ? { ...sel, translatedText: result.translatedText, isTranslating: false }\n            : sel\n        ))\n        console.log('üìù selections ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å')\n      } else {\n        // Î≤àÏó≠ Ïã§Ìå® - ÏÑ†ÌÉù ÏòÅÏó≠ Ï†úÍ±∞\n        console.log('‚ùå Î≤àÏó≠ Ïã§Ìå®')\n        setSelections(prev => prev.filter(sel => sel.id !== selection.id))\n      }\n    } catch (error) {\n      console.error('Translation error:', error)\n      setSelections(prev => prev.filter(sel => sel.id !== selection.id))\n    }\n  }\n\n  // ÏôÑÎ£åÎêú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±\n  const generateTranslatedImage = async (): Promise<string | null> => {\n    try {\n      console.log('üñºÔ∏è generateTranslatedImage ÏãúÏûë')\n      console.log('üñºÔ∏è Ï≤òÎ¶¨Ìï† selections:', selections.length)\n      \n      if (!image) {\n        console.log('‚ùå generateTranslatedImage: Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏóÜÏùå')\n        return null\n      }\n\n      const canvas = document.createElement('canvas')\n      const ctx = canvas.getContext('2d')\n      if (!ctx) {\n        console.log('‚ùå generateTranslatedImage: Ï∫îÎ≤ÑÏä§ Ïª®ÌÖçÏä§Ìä∏Î•º Í∞ÄÏ†∏Ïò¨ Ïàò ÏóÜÏùå')\n        return null\n      }\n\n      // ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞Î°ú Ï∫îÎ≤ÑÏä§ ÏÑ§Ï†ï\n      canvas.width = image.width\n      canvas.height = image.height\n\n      // ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄ Í∑∏Î¶¨Í∏∞\n      ctx.drawImage(image, 0, 0)\n      console.log('‚úÖ ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄÎ•º Ï∫îÎ≤ÑÏä§Ïóê Í∑∏Î†∏Ïùå:', canvas.width, 'x', canvas.height)\n\n      // Î≤àÏó≠Îêú ÌÖçÏä§Ìä∏Î•º Ïù¥ÎØ∏ÏßÄÏóê Ïò§Î≤ÑÎ†àÏù¥\n      selections.filter(sel => sel.translatedText).forEach((selection, index) => {\n        console.log(`üìù ÏÑ†ÌÉù ÏòÅÏó≠ ${index + 1} Ï≤òÎ¶¨:`, {\n          id: selection.id,\n          translatedText: selection.translatedText,\n          position: { x: selection.startX, y: selection.startY },\n          size: { width: selection.width, height: selection.height }\n        })\n        \n        // ÌôîÎ©¥ Ï¢åÌëúÎ•º ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄ Ï¢åÌëúÎ°ú Î≥ÄÌôò\n        const realX = selection.startX * scale.x\n        const realY = selection.startY * scale.y\n        const realWidth = selection.width * scale.x\n        const realHeight = selection.height * scale.y\n\n        console.log(`üìê Ïã§Ï†ú Ï¢åÌëú Î≥ÄÌôò:`, {\n          scale: scale,\n          real: { x: realX, y: realY, width: realWidth, height: realHeight }\n        })\n\n        // ÏÑ†ÌÉù ÏòÅÏó≠ÏùÑ Í≤ÄÏùÄÏÉâÏúºÎ°ú ÎçÆÍ∏∞\n        ctx.fillStyle = 'rgba(0, 0, 0, 0.8)'\n        ctx.fillRect(realX, realY, realWidth, realHeight)\n\n        // Î≤àÏó≠Îêú ÌÖçÏä§Ìä∏ Í∑∏Î¶¨Í∏∞\n        const text = selection.translatedText!\n        const words = text.split(' ')\n        \n        // Ìè∞Ìä∏ ÌÅ¨Í∏∞ ÏûêÎèô Ï°∞Ï†ï\n        const maxFontSize = Math.min(realHeight * 0.3, 32)\n        const minFontSize = 12\n        const maxTextWidth = realWidth * 0.9\n        const maxTextHeight = realHeight * 0.9\n        \n        let bestFontSize = minFontSize\n        \n        for (let testSize = maxFontSize; testSize >= minFontSize; testSize -= 2) {\n          ctx.font = `bold ${testSize}px Arial, sans-serif`\n          \n          // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà ÏãúÎÆ¨Î†àÏù¥ÏÖò\n          const lines: string[] = []\n          let currentLine = ''\n          \n          for (const word of words) {\n            const testLine = currentLine ? `${currentLine} ${word}` : word\n            const testWidth = ctx.measureText(testLine).width\n            \n            if (testWidth <= maxTextWidth) {\n              currentLine = testLine\n            } else {\n              if (currentLine) {\n                lines.push(currentLine)\n                currentLine = word\n              } else {\n                lines.push(word)\n              }\n            }\n          }\n          if (currentLine) lines.push(currentLine)\n          \n          // Ï¥ù ÎÜíÏù¥ Í≥ÑÏÇ∞\n          const lineHeight = testSize * 1.3\n          const totalHeight = lines.length * lineHeight\n          \n          // ÌÖçÏä§Ìä∏Í∞Ä ÏòÅÏó≠Ïóê Îì§Ïñ¥Í∞ÄÎäîÏßÄ ÌôïÏù∏\n          if (totalHeight <= maxTextHeight) {\n            bestFontSize = testSize\n          } else {\n            break\n          }\n        }\n        \n        // ÏµúÏ¢Ö Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶à Ï†ÅÏö©\n        const fontSize = Math.max(bestFontSize, minFontSize)\n        ctx.font = `bold ${fontSize}px Arial, sans-serif`\n        ctx.fillStyle = 'white'\n        ctx.textAlign = 'center'\n        ctx.textBaseline = 'top'\n        \n        console.log(`üé® ÌÖçÏä§Ìä∏ Î†åÎçîÎßÅ ÏÑ§Ï†ï:`, {\n          fontSize: fontSize,\n          text: text,\n          maxTextWidth: maxTextWidth\n        })\n        \n        const centerX = realX + realWidth / 2\n        \n        // ÏµúÏ¢Ö ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà\n        const lines: string[] = []\n        let currentLine = ''\n        \n        for (const word of words) {\n          const testLine = currentLine ? `${currentLine} ${word}` : word\n          const testWidth = ctx.measureText(testLine).width\n          \n          if (testWidth <= maxTextWidth) {\n            currentLine = testLine\n          } else {\n            if (currentLine) {\n              lines.push(currentLine)\n              currentLine = word\n            } else {\n              lines.push(word)\n            }\n          }\n        }\n        if (currentLine) lines.push(currentLine)\n        \n        const lineHeight = fontSize * 1.3\n        const totalTextHeight = lines.length * lineHeight\n        const startY = realY + (realHeight - totalTextHeight) / 2\n        \n        lines.forEach((line, index) => {\n          const lineY = startY + index * lineHeight\n          ctx.fillText(line, centerX, lineY)\n        })\n        \n        console.log(`‚úÖ ÌÖçÏä§Ìä∏ Î†åÎçîÎßÅ ÏôÑÎ£å:`, {\n          lines: lines.length,\n          totalTextHeight: totalTextHeight\n        })\n      })\n\n      console.log('üñºÔ∏è Ï∫îÎ≤ÑÏä§ Ï≤òÎ¶¨ ÏôÑÎ£å, Blob ÏÉùÏÑ± Ï§ë...')\n\n      // Ï∫îÎ≤ÑÏä§Î•º BlobÏúºÎ°ú Î≥ÄÌôò\n      const blob = await new Promise<Blob>((resolve) => {\n        canvas.toBlob((blob) => resolve(blob!), 'image/jpeg', 0.85)\n      })\n\n      console.log('üìÅ Blob ÏÉùÏÑ± ÏôÑÎ£å:', blob.size, 'bytes')\n\n      // Cloudinary ÏóÖÎ°úÎìú\n      const formData = new FormData()\n      formData.append('image', blob, 'translated.jpg')\n      formData.append('translateImage', 'false') // Ïù¥ÎØ∏ Î≤àÏó≠Îêú Ïù¥ÎØ∏ÏßÄ\n\n      console.log('‚òÅÔ∏è Cloudinary ÏóÖÎ°úÎìú ÏãúÏûë...')\n\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        body: formData\n      })\n\n      const result = await response.json()\n      console.log('‚òÅÔ∏è Cloudinary ÏóÖÎ°úÎìú ÏùëÎãµ:', result)\n      \n      if (result.success) {\n        console.log('‚úÖ generateTranslatedImage ÏÑ±Í≥µ:', result.imageUrl)\n        return result.imageUrl\n      } else {\n        console.log('‚ùå generateTranslatedImage Ïã§Ìå®:', result)\n        return null\n      }\n    } catch (error) {\n      console.error('‚ùå generateTranslatedImage ÏóêÎü¨:', error)\n      return null\n    }\n  }\n\n  // ÏôÑÎ£åÎêú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±\n  const handleComplete = async () => {\n    console.log('üî• handleComplete Ìò∏Ï∂úÎê®!')\n    console.log('üî• selections ÏÉÅÌÉú:', {\n      total: selections.length,\n      translated: selections.filter(s => s.translatedText).length,\n      translating: selections.filter(s => s.isTranslating).length\n    })\n    \n    if (selections.length === 0) {\n      console.log('‚ùå handleComplete: ÏÑ†ÌÉùÎêú ÏòÅÏó≠Ïù¥ ÏóÜÏùå')\n      return\n    }\n\n    if (selections.some(sel => sel.isTranslating)) {\n      console.log('‚ùå handleComplete: ÏïÑÏßÅ Î≤àÏó≠ Ï§ëÏù∏ ÏòÅÏó≠Ïù¥ ÏûàÏùå')\n      return\n    }\n\n    if (selections.filter(s => s.translatedText).length === 0) {\n      console.log('‚ùå handleComplete: Î≤àÏó≠Îêú ÏòÅÏó≠Ïù¥ ÏóÜÏùå')\n      return\n    }\n\n    console.log('‚úÖ handleComplete: Î≤àÏó≠Îêú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏãúÏûë')\n    setIsTranslating(true)\n\n    try {\n      const translatedImageUrl = await generateTranslatedImage()\n      if (translatedImageUrl) {\n        console.log('‚úÖ handleComplete: Î≤àÏó≠Îêú Ïù¥ÎØ∏ÏßÄ URL:', translatedImageUrl)\n        onTranslationComplete(translatedImageUrl)\n      } else {\n        console.log('‚ùå handleComplete: Î≤àÏó≠Îêú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïã§Ìå®')\n      }\n    } catch (error) {\n      console.error('‚ùå handleComplete ÏóêÎü¨:', error)\n    } finally {\n      setIsTranslating(false)\n    }\n  }\n\n  // ÏÑ†ÌÉù ÏòÅÏó≠ ÏÇ≠Ï†ú\n  const handleClearSelections = () => {\n    setSelections([])\n    setCurrentSelection(null)\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"bg-white rounded-lg shadow-sm border\">\n        <div className=\"p-4\">\n          <div className=\"text-center space-y-4\">\n            <h3 className=\"text-lg font-semibold\">Ïù¥ÎØ∏ÏßÄ Î≤àÏó≠ Ìé∏ÏßëÍ∏∞</h3>\n            <div className=\"text-sm text-gray-600 space-y-1\">\n              <p>ÎßàÏö∞Ïä§Î°ú ÎìúÎûòÍ∑∏ÌïòÏó¨ Î≤àÏó≠Ìï† ÌÖçÏä§Ìä∏ ÏòÅÏó≠ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>\n              <p className=\"text-xs\">\n                üí° <strong>ÌåÅ:</strong> ÏÑ†ÌÉùÎêú ÏòÅÏó≠ÏùÑ <span className=\"text-red-600\">ÌÅ¥Î¶≠</span>ÌïòÍ±∞ÎÇò <span className=\"text-red-600\">Ïö∞ÌÅ¥Î¶≠</span>ÌïòÎ©¥ Í∞úÎ≥Ñ ÏÇ≠Ï†úÎê©ÎãàÎã§\n              </p>\n            </div>\n            \n            <div className=\"flex justify-center\">\n              <div className=\"w-full\">\n                <canvas\n                  ref={canvasRef}\n                  onMouseDown={handleMouseDown}\n                  onMouseMove={handleMouseMove}\n                  onMouseUp={handleMouseUp}\n                  onContextMenu={handleContextMenu}\n                  className=\"cursor-crosshair block w-full border border-gray-300 rounded-lg\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"flex gap-2 justify-center\">\n              <button\n                onClick={handleClearSelections}\n                disabled={selections.length === 0}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                ÏÑ†ÌÉù Ï¥àÍ∏∞Ìôî\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleComplete}\n                disabled={selections.length === 0 || isTranslating}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isTranslating ? 'Ï≤òÎ¶¨ Ï§ë...' : 'Î≤àÏó≠ ÏôÑÎ£å'}\n              </button>\n              <button\n                type=\"button\"\n                onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  onCancel()\n                }}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\"\n              >\n                Ï∑®ÏÜå\n              </button>\n            </div>\n            \n            {selections.length > 0 && (\n              <div className=\"text-sm text-gray-600\">\n                ÏÑ†ÌÉùÎêú ÏòÅÏó≠: {selections.length}Í∞ú \n                {selections.filter(s => s.translatedText).length > 0 && \n                  ` (Î≤àÏó≠ ÏôÑÎ£å: ${selections.filter(s => s.translatedText).length}Í∞ú)`\n                }\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n} "],"names":[],"mappings":"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","debugId":null}}]
}